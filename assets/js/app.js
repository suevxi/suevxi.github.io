(function(window){function classReg(className){return new RegExp("(^|\\s+)"+className+"(\\s+|$)")}var hasClass,addClass,removeClass;if("classList" in document.documentElement){hasClass=function(elem,c){return elem.classList.contains(c)};addClass=function(elem,c){elem.classList.add(c)};removeClass=function(elem,c){elem.classList.remove(c)}}else{hasClass=function(elem,c){return classReg(c).test(elem.className)};addClass=function(elem,c){if(!hasClass(elem,c)){elem.className=elem.className+" "+c}};removeClass=function(elem,c){elem.className=elem.className.replace(classReg(c)," ")}}function toggleClass(elem,c){var fn=hasClass(elem,c)?removeClass:addClass;fn(elem,c)}var classie={hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,has:hasClass,add:addClass,remove:removeClass,toggle:toggleClass};if(typeof define==="function"&&define.amd){define(classie)}else{if(typeof exports==="object"){module.exports=classie}else{window.classie=classie}}})(window);(function(){var bodyEl=document.body,docElem=window.document.documentElement,support={transitions:Modernizr.csstransitions},transEndEventNames={"WebkitTransition":"webkitTransitionEnd","MozTransition":"transitionend","OTransition":"oTransitionEnd","msTransition":"MSTransitionEnd","transition":"transitionend"},transEndEventName=transEndEventNames[Modernizr.prefixed("transition")],onEndTransition=function(el,callback){var onEndCallbackFn=function(ev){if(support.transitions){if(ev.target!=this){return}this.removeEventListener(transEndEventName,onEndCallbackFn)}if(callback&&typeof callback==="function"){callback.call(this)}};if(support.transitions){el.addEventListener(transEndEventName,onEndCallbackFn)}else{onEndCallbackFn()}},gridEl=document.getElementById("theBlog"),sidebarEl=document.getElementById("theSidebar"),gridItemsContainer=gridEl.querySelector("section.am-g"),contentItemsContainer=gridEl.querySelector("section.am-container"),gridItems=gridItemsContainer.querySelectorAll(".m18-item"),contentItems=contentItemsContainer.querySelectorAll(".content__item"),closeCtrl=contentItemsContainer.querySelector(".close-button"),current=-1,lockScroll=false,xscroll,yscroll,isAnimating=false,menuCtrl=document.getElementById("m18-menu"),menuCloseCtrl=sidebarEl.querySelector(".close-button");function getViewport(axis){var client,inner;if(axis==="x"){client=docElem["clientWidth"];inner=window["innerWidth"]}else{if(axis==="y"){client=docElem["clientHeight"];inner=window["innerHeight"]}}return client<inner?inner:client}function scrollX(){return window.pageXOffset||docElem.scrollLeft}function scrollY(){return window.pageYOffset||docElem.scrollTop}function init(){initEvents()}function initEvents(){[].slice.call(gridItems).forEach(function(item,pos){item.addEventListener("click",function(ev){ev.preventDefault();if(isAnimating||current===pos){return false}isAnimating=true;current=pos;classie.add(item,"m18-item--loading");setTimeout(function(){classie.add(item,"m18-item--animate");setTimeout(function(){loadContent(item)},500)},1000)})});closeCtrl.addEventListener("click",function(){hideContent()});document.addEventListener("keydown",function(ev){if(!isAnimating&&current!==-1){var keyCode=ev.keyCode||ev.which;if(keyCode===27){ev.preventDefault();if("activeElement" in document){document.activeElement.blur()}hideContent()}}});menuCtrl.addEventListener("click",function(){if(!classie.has(sidebarEl,"am-sidebar--open")){classie.add(sidebarEl,"am-sidebar--open")}});menuCloseCtrl.addEventListener("click",function(){if(classie.has(sidebarEl,"am-sidebar--open")){classie.remove(sidebarEl,"am-sidebar--open")}})}function loadContent(item){var dummy=document.createElement("div");dummy.className="placeholder";dummy.style.WebkitTransform="translate3d("+(item.offsetLeft-5)+"px, "+(item.offsetTop-5)+"px, 0px) scale3d("+item.offsetWidth/gridItemsContainer.offsetWidth+","+item.offsetHeight/getViewport("y")+",1)";dummy.style.transform="translate3d("+(item.offsetLeft-5)+"px, "+(item.offsetTop-5)+"px, 0px) scale3d("+item.offsetWidth/gridItemsContainer.offsetWidth+","+item.offsetHeight/getViewport("y")+",1)";classie.add(dummy,"placeholder--trans-in");gridItemsContainer.appendChild(dummy);classie.add(bodyEl,"view-single");setTimeout(function(){dummy.style.WebkitTransform="translate3d(-5px, "+(scrollY()-5)+"px, 0px)";dummy.style.transform="translate3d(-5px, "+(scrollY()-5)+"px, 0px)";window.addEventListener("scroll",noscroll)},25);onEndTransition(dummy,function(){classie.remove(dummy,"placeholder--trans-in");classie.add(dummy,"placeholder--trans-out");contentItemsContainer.style.top=scrollY()+"px";classie.add(contentItemsContainer,"content--show");classie.add(contentItems[current],"content__item--show");classie.add(closeCtrl,"close-button--show");classie.addClass(bodyEl,"noscroll");isAnimating=false})}function hideContent(){var gridItem=gridItems[current],contentItem=contentItems[current];classie.remove(contentItem,"content__item--show");classie.remove(contentItemsContainer,"content--show");
    classie.remove(closeCtrl,"close-button--show");classie.remove(bodyEl,"view-single");setTimeout(function(){var dummy=gridItemsContainer.querySelector(".placeholder");classie.removeClass(bodyEl,"noscroll");dummy.style.WebkitTransform="translate3d("+gridItem.offsetLeft+"px, "+gridItem.offsetTop+"px, 0px) scale3d("+gridItem.offsetWidth/gridItemsContainer.offsetWidth+","+gridItem.offsetHeight/getViewport("y")+",1)";dummy.style.transform="translate3d("+gridItem.offsetLeft+"px, "+gridItem.offsetTop+"px, 0px) scale3d("+gridItem.offsetWidth/gridItemsContainer.offsetWidth+","+gridItem.offsetHeight/getViewport("y")+",1)";onEndTransition(dummy,function(){contentItem.parentNode.scrollTop=0;gridItemsContainer.removeChild(dummy);classie.remove(gridItem,"m18-item--loading");classie.remove(gridItem,"m18-item--animate");lockScroll=false;window.removeEventListener("scroll",noscroll)});current=-1},25)}function noscroll(){if(!lockScroll){lockScroll=true;xscroll=scrollX();yscroll=scrollY()}window.scrollTo(xscroll,yscroll)}init()})();